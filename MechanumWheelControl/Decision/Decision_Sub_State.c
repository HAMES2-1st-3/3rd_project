/*
 * Decision_Sub_State.c
 *
 *  Created on: 2024. 5. 10.
 *      Author: jaeeun
 *  �븘�슂 �븿�닔 諛� 湲곕뒫
 *    int32 FUNC();
 *     - ToF�꽱�꽌瑜� �넻�빐 嫄곕━媛믪쓣 �엯�젰 諛쏆븘 sub_state瑜� �뙋�떒�븯�뿬 return�븿
 *     - sub_state: 0,1,2
 *     - distance 媛� 50cm 珥덇낵�씪 寃쎌슦 normal(0)
 *     - distance 媛� 10cm 珥덇낵 && 50cm �씠�븯�씪 寃쎌슦 slow(1)
 *     - distance 媛� 10cm �씠�븯�씪 寃쎌슦 stop(2)
 *     - distance 媛� �쓬�닔�� 媛숈� �뿉�윭媛믪씪 寃쎌슦 �씠�쟾�쓽 sub_state 由ы꽩
 *
 *     -> Driver_ToF.h �궗�슜
 */


/***********************************************************************/
/*Include*/ 
/***********************************************************************/
#include <Decision_Sub_State.h>
/***********************************************************************/
/*Define*/ 
/***********************************************************************/

/***********************************************************************/
/*Typedef*/ 
/***********************************************************************/

/***********************************************************************/
/*Static Function Prototype*/ 
/***********************************************************************/

/***********************************************************************/
/*Variable*/ 
/***********************************************************************/
static uint8  s_sub_state;
sint32 dist;
/***********************************************************************/
/*Function*/ 
/***********************************************************************/
//get sub state value from tof distance value
//sub state => 0: normal / 1: slow / 2: stop
uint8 get_sub_state(void){
    dist = get_tof_distance();
    if(dist >= 0 && dist <= 105) // Include +5mm error
    {
        s_sub_state = 2;
    }
    else if(dist <= 505)         // Include +5mm error
    {
        s_sub_state = 1;
    }
    else if(dist == -1 || dist == -2) // error distance
    {
        ; // return previous sub_state
    }
    else{
        s_sub_state = 0;
    }
    return s_sub_state;
}


